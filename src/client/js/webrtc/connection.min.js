var hl=hl||{};hlsocial=hlsocial||{},function(n){"use strict";n.CONNECTION_STATUS={OFFLINE:0,ACTIVE:1,INACTIVE:2};var t=function(){function t(t,i,r,u,f,e){if(this.me=t,this.id=i,this.messages=[],this.onMessageReceived=u,this.onMessageSent=r,this.status=n.CONNECTION_STATUS.OFFLINE,this.connection=null,typeof f!="undefined"&&f!==null){console.log("Passed in connection");this.connection=f;this.connection.on("data",u)}else console.log("Creating a connection"),e?this.createConnection(e):this.createConnection()}return t.prototype.send=function(t){if(typeof t=="string"&&(console.log("Converted text to msg"),t=new n.Message({from:this.me.id,id:this.id,type:n.MESSAGE_TYPE.CHAT,text:t})),this.connection===null||this.connection.open===!1){console.log("Creating connection during send");this.createConnection(t);return}console.log("Sending "+t.type);console.log(this);console.log(this.connection.open);this.connection.send({from:t.from,id:t.id,type:t.type,text:t.text,sent:t.sent,dataUrl:t.dataUrl,fileName:t.fileName});this.onMessageSent(t)},t.prototype.createConnection=function(n){this.connection=this.me.connect(this.id);this.connection.on("data",this.onMessageReceived);var t=this;this.connection.on("open",function(){n&&(console.log("Sending from createConnection"),t.send(n))});this.connection.on("error",function(){console.log("Error from createConnection")})},t.prototype.ping=function(){console.log("Pinging "+this.id);var t=new n.Message({from:this.me.id,id:this.id,type:n.MESSAGE_TYPE.PING,text:""});this.send(t)},t}();n.Connection=t}(hlsocial);
//# sourceMappingURL=connection.min.js.map
